name: webapp

targets:
    install_node_dependencies:
        input_paths: [package.json, yarn.lock]
        output_paths: [node_modules]
        build: yarn install

    build:
        dependencies: [install_node_dependencies]
        input_paths: [.]
        output_paths: [build]
        build: yarn build

    run:
        dependencies: [install_node_dependencies]
        input_paths: [.]
        service: exec yarn start
    
    docker_build:
        dependencies: [build]
        input_paths: [Dockerfile, build]
        build: docker build -t todos/webapp .
